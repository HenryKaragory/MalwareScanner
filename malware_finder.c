#include "include/malware_finder_options.h"
#include "include/finder_sys_call.h"


void main(int argc, char *argv[]){

	// Data structures to be used in the program.
	MalwareFinderOptions mware_options;
	PersistentOptions pers_options;

	/*
	*  Let's consider a couple ways for the user to enter their data:
	*  They could pass in the malware name and what information they would
	*  like returned from command line arguments or they could be prompted by 
	*  the program to enter that information from the command line.
	*  Also, we could use a malware_finder.config file to define persistent options.
	*/

	// In both paths of execution we need to read in the persistent options from malware_finder.config.
	pers_options = get_persistent_options();

	// Path #1 - User enters the information from command line arguments (.e. argc > 1)
	// TODO: Fill up the mware_options struct with stuff we have prompted from the user
	// Path #2 - User enters the information from prompts given by the program
	if(argc > 1) {
		mware_options = get_mware_options_from_args(argc, argv);
	} else {
		mware_options = get_mware_options_from_prompt();
	}

	/* 
	*  At this point we have all the information we need to make the system call.
	*  Make the system call.
	*  TODO: Research the right way to implement this system call.
	*/
	SystemCallStruct sys_call_struct =  make_system_call(mware_options, pers_options);
	
	/*
	*  The system call ran successfully, now we need to present the user with 
	*  information about malware that was found and prompt them for additional
	*  information about what to do with this malware.
	*/
	inform_user(sys_call_struct);

	/* 
	*  End program execution, maybe persist some user data or information
	*  about the malware that was found
	*/
	persist_data(sys_call_struct);
}
