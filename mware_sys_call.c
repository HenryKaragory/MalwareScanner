#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>

#include "include/malware_finder_options.h"
#include "include/mware_sys_call.h"

unsigned long mware_scan(MalwareFinderOptions *mware_options, PersistentOptions *pers_options) {
	unsigned long mware_scan_result;
	printf("offset: %i\n", mware_options->sys_call_offset);
	mware_scan_result = syscall(mware_options->sys_call_offset, mware_options, pers_options);

	return mware_scan_result;
}