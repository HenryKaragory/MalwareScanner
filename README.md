# MalwareScanner
System 2 Class Project

### Members
A simple malware scanner by Henry Karagory, Jacob Grove, and Ian Yang.

### Overview
The program is able to find malware processes by name or by a given regular expression and it gives the user the ability to kill the process. 
The regular expression will be given through the prompts or through command line arguments. 
The name of any processes that have been killed can be saved into the config file to make it easier to discover the process in the future.  In order to run the program either use the provided demo, which is described below, or use the following steps:

From the root of the project enter the following commands from the terminal:
#### $cd lkm-syscall-v1 && make
#### $sudo insmod ./lkm/syscall.ko
#### $cd ..
#### $make
#### $./malware_finder

In short, these commands compile the files responsible for the kernel module that loads the system call used by the malware_finder program, comiple the malware_finder program, and then execute the malware finder program.  If the kernel module is already loaded, use the following command to unload the module:

#### $sudo rmmod syscall

### Description
The program utilizes four main files in order to get information, look for processes, and kill processes:

### Running the Demo
The program has a built in demonstration to help understand the functionalities of the program.
Once you are in the program folder, in order to run the demo, change directories into the demo folder:
###### $cd demo
There should be a file called demo.sh. Run this file using the sudo command:
###### $sudo sh demo.sh
and type in your sudo password.
The program will compile and run, and the user prompts will begin.
The first time the program is run, there will be nothing in the config file, so when the program asks to use saved preferences, enter
###### 'no'
The demo automatically runs two processes: malware and not_malware. Search for these processes by entering
###### 'malware'
as the name to scan for.
Search the list of running processes by replying
###### 'yes'
Enter the offset with
###### '184'
The program will execute and display all the running process with the name "malware".
For each process, you will have the option to display information about the process, to kill the process, or leave it alone.
The first process named ./malware_finder is the the process you are using. We will not kill this process. Enter
###### 'n'
The second process named ./not_malware simulates a process that is found but is known to not be malware. Enter
###### 'n'
The third process named ./malware simulates a found malware process. Enter
###### 'y'
to kill the process.
Once this is done, you will have the option to save "malware" into the config file so that every time this process is run, it will look for "malware". Save it by entering
###### 'yes'

#### get_options.c
Includes functions that store the information about what the user wants to look for, and has different functions depending on the search method.

#### malware_finder.c
The main function that goes through each step of the program. Determines the search method and calls all the other processes.

#### mware_sys_call.c
Makes the system call to kill the processes.

#### utility.c
Includes a loop that iterates through each process that matches the given regular expression and finds out what the user wants to do with the process.

### Operating Instructions
Go into the MalwareScanner folder. Compile the program using the Makefile.
Run malware_finder and give command line arguments if desired.
Additional information about running the program and adding to the configuration file can be found in sections 3 and 4 of the user manual.
